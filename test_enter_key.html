<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Enter鍵功能測試</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div style="text-align: center; padding: 50px; color: white; text-shadow: 2px 2px 0 #000;">
        <h1>⌨️ Enter鍵功能測試</h1>
        <p>這個頁面測試"再挑戰一次"功能中的Enter鍵操作</p>
        
        <div style="margin: 30px 0;">
            <h2>📋 功能說明</h2>
            <p>在分數0~3分的結局中：</p>
            <ul style="text-align: left; display: inline-block;">
                <li>✅ 滑鼠點擊"再挑戰一次"會重新開始遊戲</li>
                <li>✅ 按Enter鍵也會觸發重新開始遊戲</li>
                <li>✅ 支持鍵盤和滑鼠雙重操作</li>
                <li>✅ 即時響應，無需等待</li>
            </ul>
        </div>
        
        <div style="margin: 30px 0;">
            <h2>🎯 測試方法</h2>
            <p>1. 打開遊戲 <code>index.html</code></p>
            <p>2. 故意答錯問題，讓分數降到3分以下</p>
            <p>3. 在結局畫面按Enter鍵</p>
            <p>4. 確認遊戲重新開始</p>
        </div>
        
        <div style="margin: 30px 0;">
            <h2>🔧 技術實現</h2>
            <p><strong>Enter鍵處理邏輯：</strong></p>
            <ul style="text-align: left; display: inline-block;">
                <li>在 <code>updateEnding()</code> 函數中處理</li>
                <li>檢查 <code>keys['Enter']</code> 狀態</li>
                <li>使用 <code>ending.keyPressed</code> 防止重複觸發</li>
                <li>調用 <code>restartGame()</code> 函數</li>
            </ul>
        </div>
        
        <div style="margin: 30px 0;">
            <h2>📁 修改的文件</h2>
            <ul style="text-align: left; display: inline-block;">
                <li><code>main.js</code> - 添加Enter鍵事件處理</li>
                <li>支持Game Over模式和生氣結局模式</li>
                <li>與滑鼠點擊功能完全一致</li>
            </ul>
        </div>
        
        <div style="margin: 30px 0;">
            <h2>🎮 支持的結局模式</h2>
            <ul style="text-align: left; display: inline-block;">
                <li><strong>Game Over模式</strong>: 時間結束或愛心歸零</li>
                <li><strong>生氣結局模式</strong>: 低分數結局（≤3分）</li>
                <li><strong>高分數結局</strong>: 4分以上（不顯示"再挑戰一次"）</li>
            </ul>
        </div>
        
        <div style="margin: 30px 0;">
            <h2>⚠️ 注意事項</h2>
            <ul style="text-align: left; display: inline-block;">
                <li>Enter鍵只在菜單顯示後（<code>menuAlpha > 0.5</code>）才有效</li>
                <li>使用 <code>keyPressed</code> 標誌防止重複觸發</li>
                <li>與滑鼠點擊功能完全同步</li>
            </ul>
        </div>
    </div>

    <script>
        // 模擬遊戲狀態
        const state = {
            mode: 'end',
            paused: false
        };

        // 模擬結局狀態
        const ending = {
            active: true,
            hearts: 2, // 低分數
            gameOverMode: true,
            phase: 'gameOver',
            menuOptions: ['再挑戰一次'],
            menuAlpha: 1,
            typewriterText: '再挑戰一次',
            typewriterIndex: 10,
            gameOverTimer: 3000,
            keyPressed: false
        };

        // 模擬重新開始遊戲函數
        function restartGame() {
            alert('🎮 遊戲重新開始！\n\n這表示Enter鍵功能正常工作！\n\n在實際遊戲中，這會：\n• 重置所有遊戲狀態\n• 重新開始計時\n• 重置愛心數量\n• 重新開始遊戲循環');
        }

        // 模擬鍵盤事件處理
        const keys = {};
        window.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            
            // 模擬Enter鍵處理邏輯
            if(e.key === 'Enter' && state.mode === 'end' && ending.active){
                if(ending.gameOverMode && ending.menuAlpha > 0.5 && !ending.keyPressed){
                    ending.keyPressed = true;
                    restartGame();
                }
            }
        });

        window.addEventListener('keyup', (e) => {
            keys[e.key] = false;
            
            // 重置keyPressed標誌
            if(e.key === 'Enter'){
                ending.keyPressed = false;
            }
        });

        console.log('🧪 Enter鍵測試頁面已加載');
        console.log('⌨️ 測試方法：');
        console.log('1. 在實際遊戲中故意答錯問題讓分數降到3分以下');
        console.log('2. 在結局畫面按Enter鍵');
        console.log('3. 確認遊戲重新開始');
        console.log('4. 也可以點擊"再挑戰一次"選項');
    </script>
</body>
</html>
